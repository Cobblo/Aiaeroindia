{% extends "base.html" %}
{% load static %}
{% block title %}Products{% endblock %}

{% block content %}
<section class="products-wrap">
  <style>
    .products-wrap{margin:40px auto;max-width:1200px;padding:0 12px;}
    .hdr{text-align:center;margin-bottom:22px}
    .hdr h2{font-weight:800;margin-bottom:6px}
    .hdr p{color:#6b7280;margin:0}

    /* Reference-style layout: 250px cards with even gaps */
    .fp-grid{display:flex;flex-wrap:wrap;gap:30px;justify-content:center}

    .fp-card{
      width:250px;border:1px solid #eee;border-radius:10px;background:#fff;
      padding:15px;text-align:center;box-shadow:0 4px 8px rgba(0,0,0,.05);
      position:relative;display:flex;flex-direction:column;min-height:100%;
      transition:transform .18s ease, box-shadow .18s ease;
    }
    .fp-card:hover{transform:translateY(-2px);box-shadow:0 10px 20px rgba(0,0,0,.08);}

    .fp-thumb{border-radius:10px;overflow:hidden;background:#f7f8fb;margin-bottom:10px;}
    .fp-thumb img{width:100%;height:200px;object-fit:cover;object-position:center;display:block;}

    .fp-name{
      font-weight:700;font-size:1.05rem;color:#111827;margin:6px 0 4px;
      text-decoration:none;display:block;
    }
    .fp-name:hover{color:#0b1220;}

    .fp-price{color:#d23a24;font-weight:800;margin-bottom:12px;}

    .fp-btn{
      background:#002244;color:#fff;border:0;border-radius:8px;
      padding:10px 14px;font-weight:700;width:100%;position:relative;z-index:2;
    }
    .fp-btn:hover{filter:brightness(1.03);}
  </style>

  <div class="container">
    <div class="hdr">
      <h2>Products</h2>
      <p>Explore our featured products</p>
    </div>

    {% if products %}
      <div class="fp-grid">
        {% for p in products %}
          <article class="fp-card">

            <a href="{{ p.get_absolute_url }}" class="fp-thumb">
              {% with img=p.images.all.0 %}
                {% if img %}
                  <img src="{{ img.image.url }}" alt="{{ img.alt|default:p.name }}">
                {% else %}
                  <img src="{% static 'assets/img/placeholder-4x3.jpg' %}" alt="{{ p.name }}">
                {% endif %}
              {% endwith %}
            </a>

            <a href="{{ p.get_absolute_url }}" class="fp-name">{{ p.name }}</a>
            <div class="fp-price">â‚¹{{ p.price|floatformat:0 }}</div>

            {% if p.stock|default:0 > 0 %}
              <form method="post" action="{% url 'cart:add' p.id %}" class="mt-auto">
                {% csrf_token %}
                <input type="hidden" name="quantity" value="1">
                <button type="submit" class="fp-btn">Add to Cart</button>
              </form>
            {% else %}
              <button type="button" class="fp-btn" disabled>Out of Stock</button>
            {% endif %}

            <!-- whole card clickable, button stays on top -->
            <a href="{{ p.get_absolute_url }}" class="stretched-link" aria-label="{{ p.name }}"></a>

          </article>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-center text-muted">No products found.</p>
    {% endif %}
  </div>
</section>
{% endblock %}
